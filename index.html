<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magic 8-Ball</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght @400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Tailwind's gray-900 */
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            text-align: center;
            padding: 1rem;
        }

        .container {
            width: 100%;
            max-width: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        .eight-ball {
            position: relative;
            width: 250px;
            height: 250px;
            background-color: #1a202c;
            border-radius: 50%;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
            animation: pulse 2s infinite ease-in-out;
        }

        .eight-ball:hover {
            transform: scale(1.05);
        }

        .eight-ball-window {
            width: 120px;
            height: 120px;
            background-color: #0d121c;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            padding: 10px;
            box-shadow: inset 0 0 20px rgba(255,255,255,0.2), 0 0 10px rgba(255,255,255,0.5);
            font-style: italic;
            font-size: 1rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }

        .eight-ball-text {
            text-align: center;
        }

        .triangle {
            width: 0;
            height: 0;
            border-left: 60px solid transparent;
            border-right: 60px solid transparent;
            border-top: 100px solid #0d121c;
            transform: rotate(-180deg);
        }

        .shake-animation {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
            transform: translate3d(0, 0, 0);
            backface-visibility: hidden;
            perspective: 1000px;
        }

        @keyframes pulse {
            0% { box-shadow: inset 0 0 50px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.8); }
            50% { box-shadow: inset 0 0 60px rgba(0,0,0,0.6), 0 15px 25px rgba(0,0,0,0.9); }
            100% { box-shadow: inset 0 0 50px rgba(0,0,0,0.5), 0 10px 20px rgba(0,0,0,0.8); }
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1 class="text-3xl font-bold mb-4">The Magic 8-Ball</h1>
        <p class="text-gray-400 mb-6">Ask a yes/no question, then click the 8-Ball for advice!</p>

        <input type="text" id="question-input" class="bg-gray-700 text-white w-full px-4 py-2 rounded mb-4" placeholder="Your Question...">

        <div id="eight-ball" class="eight-ball">
            <div id="eight-ball-window" class="eight-ball-window">
                <span id="eight-ball-text" class="eight-ball-text">8</span>
            </div>
        </div>

        <button id="share-button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-4" style="display: none;">
            Share the Answer
        </button>

        <div id="log-container" class="w-full mt-8">
            <h2 class="text-xl font-bold mb-4">Your Recent Questions</h2>
            <div id="question-log" class="text-left"></div>
        </div>
    </div>

    <script>
        const eightBallEl = document.getElementById('eight-ball');
        const eightBallTextEl = document.getElementById('eight-ball-text');
        const shareButtonEl = document.getElementById('share-button');
        const questionInputEl = document.getElementById('question-input');
        const questionLogEl = document.getElementById('question-log');

        const answerCategories = {
            affirmative: [
                "It is certain.", "It is decidedly so.", "Without a doubt.", "Yes, definitely.",
                "You may rely on it.", "As I see it, yes.", "Most likely.", "Outlook good.", "Yes.",
                "Signs point to yes."
            ],
            negative: [
                "Don’t count on it.", "My reply is no.", "My sources say no.", "Outlook not so good.",
                "Very doubtful.", "The PHB says no."
            ],
            nonCommittal: [
                "Reply hazy, try again.", "Ask again later.", "Better not tell you now.", "Cannot predict now.",
                "Concentrate and ask again.", "I’m 99% sure… but my confidence interval is wide.",
                "The answer requires a software update."
            ],
            humorousAndSarcastic: [
                "I’d tell you, but I’m contractually obligated to be mysterious.", "Does a bear code in the woods?",
                "I’d say yes, but I’m just a ball.", "Sure, if you believe in magic.", "The answer is 42.",
                "My sources are a Magic 8 Ball. So, no clue.", "The Magic 8 Ball has left the chat.",
                "The dolphins say yes.", "My inner squirrel says no.", "The cookies say ‘eat me’ first.",
                "I’d answer, but I’m busy judging your life choices.", "The answer is ‘yes,’ but only if you promise to blame me later.",
                "The answer is ‘no,’ but here’s a participation trophy.", "I’d tell you, but my therapist says I’m too honest.",
                "I’m not saying ‘no,’ but have you considered therapy?", "The answer is 'maybe,' but HR needs to approve it first.",
                "The answer is 'yes,' but you’ll need to fill out form 37B in triplicate.", "The answer is 'no,' but let’s form a committee to discuss it.",
                "The answer is 'yes,' but the budget has been reallocated to a synergy workshop.", "The answer is 'no,' but we’ll call it a ‘strategic pivot’.",
                "The answer is 'yes,' but what’s the point?", "The answer is 'maybe,' but existence is suffering.",
                "The answer is 'yes,' but the universe is indifferent.", "The answer is 'no,' but at least you’re salaried.",
                "The answer is 'yes,' but your soul will wither.", "The answer is 'no,' but have you tried caffeine?",
                "The answer is 'yes,' but you need 7 signatures.", "The answer is 'no,' but let’s schedule a follow-up.",
                "The answer is 'maybe,' but it’s outside your swimlane.", "The answer is 'yes,' but it’s not in the SOP.",
                "The answer is 'no,' but we’ll create a subcommittee to explore it.", "The answer is 'yes,' but only if you CC my manager.",
                "The answer is 'no,' but let’s pretend it’s a win.", "The answer is 'maybe,' but the printer is jammed.",
                "The answer is 'yes,' but the coffee machine is empty.", "The answer is 'no,' but the free snacks are gone.",
                "The answer is 'yes,' but the meeting could’ve been an email.", "The answer is 'no,' but the dress code is ‘business casual’."
            ],
            techThemed: [
                "The algorithm says yes.", "My AI overlords say no.", "The WiFi says maybe.", "Error 44: Answer not found.",
                "Ask Siri.", "The cloud is still loading.", "My crystal ball is buffering.", "The universe is on mute. Try again.",
                "The answer is in the blockchain.", "The answer is ‘maybe,’ but my WiFi is spotty.", "The answer is ‘yes,’ but only in beta.",
                "The answer is ‘no,’ but the error message is cryptic.", "The answer is ‘maybe,’ but the API is down.",
                "The answer is ‘yes,’ but it’s a false positive.", "The answer is ‘no,’ but the documentation is unclear.",
                "The answer is ‘yes,’ but it’s deprecated.", "The answer is ‘no,’ but the logs say otherwise.",
                "The answer is ‘maybe,’ but the cache is stale."
            ],
            popCulture: [
                "The answer is in another castle.", "May the Force be with you.", "To infinity and beyond!",
                "Winter is coming… so yes?", "Live long and prosper.", "The answer is written in the stars (and your search history)."
            ],
            motivational: [
                "You’ve got this!", "The stars align in your favor.", "Trust your gut.", "Why not? Adventure awaits!",
                "The vibes say yes.", "Go for it!", "The universe believes in you."
            ]
        };

        let responseHistory = [];
        let qaHistory = [];
        let categoryHistory = [];

        function updateLog() {
            questionLogEl.innerHTML = '';
            qaHistory.forEach(item => {
                const logEntry = document.createElement('div');
                logEntry.className = 'mb-2 p-2 bg-gray-800 rounded';
                logEntry.innerHTML = `<p class="font-semibold">Q: ${item.question}</p><p>A: ${item.answer}</p>`;
                questionLogEl.appendChild(logEntry);
            });
        }

        function getBalancedAnswer() {
            let availableCategories = Object.keys(answerCategories);

            // If the last two answers were from the same category, exclude it to ensure variety
            if (categoryHistory.length > 1 && categoryHistory[0] === categoryHistory[1]) {
                availableCategories = availableCategories.filter(cat => cat !== categoryHistory[0]);
            }

            let attempts = 0;
            while (attempts < 10) { // Failsafe to prevent infinite loops
                const randomCategoryKey = availableCategories[Math.floor(Math.random() * availableCategories.length)];
                const potentialAnswers = answerCategories[randomCategoryKey];
                
                // Filter out answers that have been shown recently
                const availableAnswers = potentialAnswers.filter(answer => !responseHistory.includes(answer));

                if (availableAnswers.length > 0) {
                    const randomAnswer = availableAnswers[Math.floor(Math.random() * availableAnswers.length)];
                    
                    // Update category history
                    categoryHistory.unshift(randomCategoryKey);
                    if (categoryHistory.length > 2) {
                        categoryHistory.pop();
                    }
                    
                    return randomAnswer;
                }
                attempts++;
            }

            // Fallback in case a suitable answer isn't found (e.g., all answers in available categories are in history)
            const allAnswers = Object.values(answerCategories).flat();
            return allAnswers[Math.floor(Math.random() * allAnswers.length)];
        }

        eightBallEl.addEventListener('click', () => {
            const question = questionInputEl.value.trim();
            if (!question) {
                alert('Please ask a question first!');
                return;
            }

            // Add shake animation
            eightBallEl.classList.add('shake-animation');
            
            // Clear previous answer and show the 8
            eightBallTextEl.textContent = '8';
            shareButtonEl.style.display = 'none';

            setTimeout(() => {
                const randomAnswer = getBalancedAnswer();
                eightBallTextEl.textContent = randomAnswer;

                // Add the new response to the history
                responseHistory.push(randomAnswer);
                if (responseHistory.length > 25) {
                    responseHistory.shift();
                }

                // Add question-answer pair to the log
                qaHistory.push({ question, answer: randomAnswer });
                if (qaHistory.length > 5) {
                    qaHistory.shift();
                }
                updateLog();

                // Clear the input
                questionInputEl.value = '';

                // Show the share button
                shareButtonEl.style.display = 'block';

                // Remove shake animation after it completes
                eightBallEl.classList.remove('shake-animation');
            }, 500); // Duration of the shake animation
        });

        shareButtonEl.addEventListener('click', () => {
            const answer = eightBallTextEl.textContent;
            if (navigator.share) {
                navigator.share({
                    title: 'Magic 8-Ball Answer',
                    text: `The Magic 8-Ball says: "${answer}"`,
                    url: window.location.href
                }).then(() => {
                    console.log('Thanks for sharing!');
                }).catch(console.error);
            } else {
                // Fallback for browsers that don't support the Web Share API
                navigator.clipboard.writeText(`The Magic 8-Ball says: "${answer}"`).then(() => {
                    alert('Answer copied to clipboard!');
                }).catch(console.error);
            }
        });
    </script>
</body>
</html>